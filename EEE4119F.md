# Lecture 1:Numerical Integration
- Initial condition is crucial:
## Euler Method
### Euler Algorithm
- We generally want to take small increments (∆𝑡), so:
$$
y_n = y_{n-1} + \frac{dy}{dt}\Bigr\rvert_{t = 0}\Delta t
$$
## Taylor Series
- Consider an arbitrary function (y)
- We can make an approximation:
$$
\hat{y} = a +bt +ct^2 + dt^3 + ...
$$
- Solve for coefficients
• Simplest approximation would be to use derivative:
$$
\hat{y} = y(t=0) + \frac{dy}{dt}\Bigr\rvert_{t = 0}t
$$
- We can make this better with second derivative:
$$\text{put formula on page 16 of lecture 1 slides}$$
- Add more derivatives:
$$\text{formula on page 16 of lecture 1 slides}$$
- Called Taylor Series
### Error Analysis
• Initial value problem:
Euler method
Error term
• Only need to care about first term
• Why?
• Error scales with ∆𝒕
• If we half ∆𝒕 , then we half the error!
Euler Error
## Midpoint Method Error
- Extrapolation based on midpoint gradient:
- Exactly Taylor approximation of y for first three terms
	- Much more accurate than Euler!
- Let’s use Euler:
$$y_{N+\frac{1}{2}} = y_N + \frac{\Delta t}{2}\frac{dy}{dt}\Bigr\rvert_{N}$$
- Then using $y_{N+\frac{1}{2}}$ and $\frac{\Delta{t}}{2}$ , can calculate the derivative
- Last step in algorithm is then:
$$
y_{N+1} = y_N + \Delta{t}\frac{dy}{dt}\Bigr\rvert_{N+\frac{1}{2}}
$$
### Midpoint Method Steps
- `Step1: Euler`   $y_{N+\frac{1}{2}} = y_N + \frac{\Delta t}{2}\frac{dy}{dt}\Bigr\rvert_{N}$
- `Step2: Deriv`   $\frac{dy}{dt}\Bigr\rvert_{N+\frac{1}{2}}$
- `Step3: Shoot to end`: $y_{N+1} = y_N + \Delta{t}\frac{dy}{dt}\Bigr\rvert_{N+\frac{1}{2}}$
## Runge-Kutta Method
- Instead of shooting to midpoint, shoot to 4 specific points
- RK4 Algorithm
Assume: $\frac{d{y}}{d{t}} = f(y,t)$
Then:
$$
\begin{align*}
k_1 &= \Delta{t}f\left ( y_N, t_N \right )\\
k_2 &= \Delta{t}f\left ( y_N + \frac{k_1}{2}, t_N + \frac{\Delta{t}}{2} \right )\\
k_3 &= \Delta{t}f\left ( y_N + \frac{k_2}{2}, t_N + \frac{\Delta{t}}{2} \right )\\
k_4 &= \Delta{t}f\left ( y_N + k_3, t_N + \Delta{t} \right )\\
y_{N+1} &= y_N + \frac{1}{6} \left ( k_1 +2k_2 +2k_3 +k4 \right )
\end{align*}
$$
# Lecture 2:Lagrange Mechanics I
• Generalised
Coordinates
• Lagrange
Mechanics
Overview
Festo – Bionic Softarm
Pendulum using Newton
• Position: 𝒓 = 𝑥
𝑦
• Equations:
Massless rod of length 𝜌
• Constraint:
• In 𝑥 and 𝑦
𝑥2 + 𝑦2 = 𝜌2
𝒓 = 𝑥
𝑦 = 𝜌𝑠𝑖𝑛𝜃
−𝜌𝑐𝑜𝑠𝜃ρ
(x,y)
m
X
Y
Kinematics
• Position:ρθ
(x,y)
m 𝒓 = 𝜌𝑠𝑖𝑛𝜃
−𝜌𝑐𝑜𝑠𝜃
• Velocity: ሶ 𝒓 = 𝜌cos(𝜃) ሶ 𝜃
𝜌sin(𝜃) ሶ 𝜃
• Acceleration: ሷ 𝒓 = −𝜌(sin 𝜃 ሶ 𝜃2 − 𝑐𝑜𝑠𝜃 ሷ 𝜃)
𝜌(cos 𝜃 ሶ 𝜃2 + 𝑠𝑖𝑛𝜃 ሷ 𝜃)
Forces
• From FBD:
𝑭 = 𝑇 𝒓
𝒓 − 𝑚𝒈
∴ 𝑭 = 𝑇 𝒓
𝜌 − 𝑚𝒈rθ
mg
T
Newton II
• Newton 2nd:ρθ
(x,y)
m
𝑚 ሷ 𝒓 = 𝑭
𝑚 ሷ 𝒓 = 𝑇 𝒓
𝒓 − 𝑚𝒈
• Matrix form:
𝑚 −𝜌(sin 𝜃 ሶ 𝜃2 + 𝑐𝑜𝑠𝜃 ሷ 𝜃)
𝜌(cos 𝜃 ሶ 𝜃2 + 𝑠𝑖𝑛𝜃 ሷ 𝜃) = 𝑇 𝑠𝑖𝑛𝜃
−𝑐𝑜𝑠𝜃 − 0
𝑚𝑔
•  - nonlinear, coupled
• → solve for ሷ 𝜃 and 𝑇 … but only one DOF!
Generalised Coordinates
• Admin
• Generalised
Coordinates
• Lagrange
Mechanics
Lecture 2:
Lagrange I
• Consider 𝑵 particles
• Can describe configuration as:
• Most times, there are constraints…
• Can then describe configuration
using less parameters (𝑛 ≤ 3𝑁)
• Generalized coordinates (𝒒)
𝒑𝑵 = 𝑥𝑁 𝑦𝑁 𝑧𝑁 𝑻m1
i
j
k
m2
m3
mN
p1
p2
p3
pN
Generalised Coordinates
• Admin
• Generalised
Coordinates
• Lagrange
Mechanics
Lecture 2:
Lagrange I
• Must be able to relate q’s and p’s
• q’s not necessarily similar
• Eg. Polar coordinates 𝑟, 𝜃
• Try to choose independent q’s
• But generally:
• 𝑚 is number of constraint equations
𝒑𝑵 = 𝒇(𝒒, 𝒕)
𝐷𝑂𝐹 = 𝑛 − 𝑚r
θ
(x,y)
m
OR
Constraints
• If a constraint takes the form:
• Holonomic constraint:
• Example (3D pendulum)
𝜑 𝒒 = 0
𝜑 𝒒 = 0 = 𝑥2 + 𝑦2 + 𝑧2 − 𝑙2
𝒒 = 𝑥 𝑦 𝑧 𝑇
Non-holonomic Constraints
• If a constraint takes the form:
• Example (rolling disk)
• Rolling constraints:
𝜑 𝒒, ሶ 𝒒 = 0
𝒒 = 𝑥 𝑦 𝜃 𝜑 𝑇
ሶ
𝑥 − 𝜌 cos 𝜃 ሶ 𝜑 = 0
ሶ
𝑦 − 𝜌 sin 𝜃 ሶ 𝜑 = 0
𝜌
Sliding wedge with point mass
• What is 𝒒?
𝒒 = 𝑋 𝑥 𝑇m
M
α
X
x
0
Double Pendulum
• What should the 𝒒’s be?m2
m1β
α
x1,y1
x2,y2
𝒒 = 𝛼 𝛽 𝑇
Kinetic Energy
• Total Kinetic Energy of system (𝑇)
• For point particles:
• What about rigid bodies?
• Include rotational energy & inertias
𝑇 = 1
2 ෍
𝑖=1
𝑁
𝑚𝑖 ሶ 𝒓𝒊
𝟐
𝑓(𝒒, ሶ 𝒒)
Potential Energy
• Potential Energy from Gravity (𝑽𝒈𝒓𝒂𝒗)
𝑉 = ෍
𝑖=1
𝑁
𝑚𝑖 𝑔ℎ𝑖
𝑓(𝒒)
• Potential Energy from springs (𝑽𝒔)
𝑉 = 1
2 ෍
𝑖=1
𝑁
𝑘𝑖 𝑥𝑖
2 𝑓(𝒒)
Lagrange Mechanics
• Admin
• Generalised
Coordinates
• Lagrange
Mechanics
Lecture 2:
Lagrange I
• Developed by Joseph Lagrange
• Derived from Calculus of Variations
• An energy-based method of describing
mechanics
• Great for constrained systems:
• Works with Generalised Coordinates
• Does not require constraint forces
The Lagrangian
𝐿 𝒒, ሶ 𝒒 = 𝑇 𝒒, ሶ 𝒒 − 𝑉 𝒒
Total system Kinetic energy Potential energy
EOM
• Dynamic equation for coordinate 𝑞𝑖
𝑑
𝑑𝑡
𝜕𝐿
𝜕 ሶ 𝑞𝑖
− 𝜕𝐿
𝜕𝑞𝑖
= 0
• Repeat for all 𝑖
Eg: Pendulum
𝒒 = 𝜃
• Generalised coords:
• Position:ρθ
(x,y)
m 𝒓 = 𝜌sin(𝜃)
−𝜌cos(𝜃)
• Velocity: ሶ 𝒓 = 𝜌cos(𝜃) ሶ 𝜃
𝜌sin(𝜃) ሶ 𝜃
Eg: Pendulum
𝑇 = 1
2 𝑚 ሶ 𝒓2
• Kinetic Energy:ρθ
(x,y)
m
= 1
2 𝑚[(𝜌𝑐𝑜𝑠(𝜃) ሶ 𝜃)2+(𝜌𝑠𝑖𝑛(𝜃) ሶ 𝜃)2]
= 1
2 𝑚𝜌2 ሶ 𝜃2
Eg: Pendulum
𝑉 = 𝑚𝑔𝑟𝑦
• Potential Energy:ρθ
(x,y)
m
= 𝑚𝑔(−𝜌 cos 𝜃 )
• Lagrangian:
𝐿 = 𝑇 − 𝑉
𝐿 = 1
2 𝑚𝜌2 ሶ 𝜃2 + 𝑚𝑔𝜌 cos 𝜃
EOM (Pendulum)
𝑑
𝑑𝑡
𝜕𝐿
𝜕 ሶ 𝜃 − 𝜕𝐿
𝜕𝜃 = 0
𝜕𝐿
𝜕 ሶ 𝜃 = 𝑚𝜌2 ሶ 𝜃
𝑑
𝑑𝑡
𝜕𝐿
𝜕 ሶ 𝜃 = 𝑚𝜌2 ሷ 𝜃
𝜕𝐿
𝜕𝜃 = −𝑚𝑔𝜌sin(𝜃)
EOM (Pendulum)
𝑑
𝑑𝑡
𝜕𝐿
𝜕 ሶ 𝜃 − 𝜕𝐿
𝜕𝜃 = 0
𝑚𝜌2 ሷ 𝜃 + 𝑚𝑔𝜌𝑠𝑖 𝑛 𝜃 = 0
𝜌 ሷ 𝜃 + 𝑔𝑠𝑖 𝑛 𝜃 = 0
ሷ
𝜃 = − 𝑔
𝜌 𝑠𝑖𝑛(𝜃)
Eg: Mass with spring
𝒒 = 𝑥
• Generalised coords:
• Position: 𝒓 = 𝑥
• Velocity: ሶ 𝒓 = ሶ 𝑥m
α
Eg: Mass with springm
α
𝑉𝑔 = −𝑚𝑔𝑥𝑠𝑖𝑛 𝛼
• Potential Energy Gravity:
• Potential Energy Spring:
𝑉𝑠 = 1
2 𝑘𝑥2
Eg: Mass with spring
• Lagrangian:
𝐿 = 𝑇 − 𝑉
𝐿 = 1
2 𝑚 ሶ 𝑥2 − (−𝑚𝑔𝑥𝑠𝑖𝑛 𝛼 + 1
2 𝑘𝑥2)
𝐿 = 1
2 𝑚 ሶ 𝑥2 + 𝑚𝑔𝑥𝑠𝑖𝑛 𝛼 − 1
2 𝑘𝑥2)
Eg: Mass with spring
• EOM: 𝑑
𝑑𝑡
𝜕𝐿
𝜕 ሶ 𝑥 − 𝜕𝐿
𝜕𝑥 = 0
𝑑
𝑑𝑡 𝑚 ሶ 𝑥 − 𝑚𝑔𝑠𝑖𝑛 𝛼 − 𝑘𝑥 = 0
𝑚 ሷ 𝑥 + 𝑘𝑥 = 𝑚𝑔𝑠𝑖𝑛 𝛼
𝑑
𝑑𝑡
𝜕𝐿
𝜕 ሶ 𝑥 − 𝜕𝐿
𝜕𝑥 = 0
Homework Exercisex,y
α
b
β
a
• Rigid rod attached
to a string
• Derive EOM
m, I
The end.
• Next lecture:
• Multibody
systems