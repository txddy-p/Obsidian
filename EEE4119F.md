# Lecture 1:Numerical Integration
- Initial condition is crucial:
## Euler Method
### Euler Algorithm
- We generally want to take small increments (âˆ†ğ‘¡), so:
$$
y_n = y_{n-1} + \frac{dy}{dt}\Bigr\rvert_{t = 0}\Delta t
$$
## Taylor Series
- Consider an arbitrary function (y)
- We can make an approximation:
$$
\hat{y} = a +bt +ct^2 + dt^3 + ...
$$
- Solve for coefficients
â€¢ Simplest approximation would be to use derivative:
$$
\hat{y} = y(t=0) + \frac{dy}{dt}\Bigr\rvert_{t = 0}t
$$
- We can make this better with second derivative:
$$\text{put formula on page 16 of lecture 1 slides}$$
- Add more derivatives:
$$\text{formula on page 16 of lecture 1 slides}$$
- Called Taylor Series
### Error Analysis
â€¢ Initial value problem:
Euler method
Error term
â€¢ Only need to care about first term
â€¢ Why?
â€¢ Error scales with âˆ†ğ’•
â€¢ If we half âˆ†ğ’• , then we half the error!
Euler Error
## Midpoint Method Error
- Extrapolation based on midpoint gradient:
- Exactly Taylor approximation of y for first three terms
	- Much more accurate than Euler!
- Letâ€™s use Euler:
$$y_{N+\frac{1}{2}} = y_N + \frac{\Delta t}{2}\frac{dy}{dt}\Bigr\rvert_{N}$$
- Then using $y_{N+\frac{1}{2}}$ and $\frac{\Delta{t}}{2}$ , can calculate the derivative
- Last step in algorithm is then:
$$
y_{N+1} = y_N + \Delta{t}\frac{dy}{dt}\Bigr\rvert_{N+\frac{1}{2}}
$$
### Midpoint Method Steps
- `Step1: Euler`   $y_{N+\frac{1}{2}} = y_N + \frac{\Delta t}{2}\frac{dy}{dt}\Bigr\rvert_{N}$
- `Step2: Deriv`   $\frac{dy}{dt}\Bigr\rvert_{N+\frac{1}{2}}$
- `Step3: Shoot to end`: $y_{N+1} = y_N + \Delta{t}\frac{dy}{dt}\Bigr\rvert_{N+\frac{1}{2}}$
## Runge-Kutta Method
- Instead of shooting to midpoint, shoot to 4 specific points
- RK4 Algorithm
Assume: $\frac{d{y}}{d{t}} = f(y,t)$
Then:
$$
\begin{align*}
k_1 &= \Delta{t}f\left ( y_N, t_N \right )\\
k_2 &= \Delta{t}f\left ( y_N + \frac{k_1}{2}, t_N + \frac{\Delta{t}}{2} \right )\\
k_3 &= \Delta{t}f\left ( y_N + \frac{k_2}{2}, t_N + \frac{\Delta{t}}{2} \right )\\
k_4 &= \Delta{t}f\left ( y_N + k_3, t_N + \Delta{t} \right )\\
y_{N+1} &= y_N + \frac{1}{6} \left ( k_1 +2k_2 +2k_3 +k4 \right )
\end{align*}
$$
# Lecture 2:Lagrange Mechanics I
â€¢ Generalised
Coordinates
â€¢ Lagrange
Mechanics
Overview
Festo â€“ Bionic Softarm
Pendulum using Newton
â€¢ Position: ğ’“ = ğ‘¥
ğ‘¦
â€¢ Equations:
Massless rod of length ğœŒ
â€¢ Constraint:
â€¢ In ğ‘¥ and ğ‘¦
ğ‘¥2 + ğ‘¦2 = ğœŒ2
ğ’“ = ğ‘¥
ğ‘¦ = ğœŒğ‘ ğ‘–ğ‘›ğœƒ
âˆ’ğœŒğ‘ğ‘œğ‘ ğœƒÏ
(x,y)
m
X
Y
Kinematics
â€¢ Position:ÏÎ¸
(x,y)
m ğ’“ = ğœŒğ‘ ğ‘–ğ‘›ğœƒ
âˆ’ğœŒğ‘ğ‘œğ‘ ğœƒ
â€¢ Velocity: áˆ¶ ğ’“ = ğœŒcos(ğœƒ) áˆ¶ ğœƒ
ğœŒsin(ğœƒ) áˆ¶ ğœƒ
â€¢ Acceleration: áˆ· ğ’“ = âˆ’ğœŒ(sin ğœƒ áˆ¶ ğœƒ2 âˆ’ ğ‘ğ‘œğ‘ ğœƒ áˆ· ğœƒ)
ğœŒ(cos ğœƒ áˆ¶ ğœƒ2 + ğ‘ ğ‘–ğ‘›ğœƒ áˆ· ğœƒ)
Forces
â€¢ From FBD:
ğ‘­ = ğ‘‡ ğ’“
ğ’“ âˆ’ ğ‘šğ’ˆ
âˆ´ ğ‘­ = ğ‘‡ ğ’“
ğœŒ âˆ’ ğ‘šğ’ˆrÎ¸
mg
T
Newton II
â€¢ Newton 2nd:ÏÎ¸
(x,y)
m
ğ‘š áˆ· ğ’“ = ğ‘­
ğ‘š áˆ· ğ’“ = ğ‘‡ ğ’“
ğ’“ âˆ’ ğ‘šğ’ˆ
â€¢ Matrix form:
ğ‘š âˆ’ğœŒ(sin ğœƒ áˆ¶ ğœƒ2 + ğ‘ğ‘œğ‘ ğœƒ áˆ· ğœƒ)
ğœŒ(cos ğœƒ áˆ¶ ğœƒ2 + ğ‘ ğ‘–ğ‘›ğœƒ áˆ· ğœƒ) = ğ‘‡ ğ‘ ğ‘–ğ‘›ğœƒ
âˆ’ğ‘ğ‘œğ‘ ğœƒ âˆ’ 0
ğ‘šğ‘”
â€¢ ïŒ - nonlinear, coupled
â€¢ â†’ solve for áˆ· ğœƒ and ğ‘‡ â€¦ but only one DOF!
Generalised Coordinates
â€¢ Admin
â€¢ Generalised
Coordinates
â€¢ Lagrange
Mechanics
Lecture 2:
Lagrange I
â€¢ Consider ğ‘µ particles
â€¢ Can describe configuration as:
â€¢ Most times, there are constraintsâ€¦
â€¢ Can then describe configuration
using less parameters (ğ‘› â‰¤ 3ğ‘)
â€¢ Generalized coordinates (ğ’’)
ğ’‘ğ‘µ = ğ‘¥ğ‘ ğ‘¦ğ‘ ğ‘§ğ‘ ğ‘»m1
i
j
k
m2
m3
mN
p1
p2
p3
pN
Generalised Coordinates
â€¢ Admin
â€¢ Generalised
Coordinates
â€¢ Lagrange
Mechanics
Lecture 2:
Lagrange I
â€¢ Must be able to relate qâ€™s and pâ€™s
â€¢ qâ€™s not necessarily similar
â€¢ Eg. Polar coordinates ğ‘Ÿ, ğœƒ
â€¢ Try to choose independent qâ€™s
â€¢ But generally:
â€¢ ğ‘š is number of constraint equations
ğ’‘ğ‘µ = ğ’‡(ğ’’, ğ’•)
ğ·ğ‘‚ğ¹ = ğ‘› âˆ’ ğ‘šr
Î¸
(x,y)
m
OR
Constraints
â€¢ If a constraint takes the form:
â€¢ Holonomic constraint:
â€¢ Example (3D pendulum)
ğœ‘ ğ’’ = 0
ğœ‘ ğ’’ = 0 = ğ‘¥2 + ğ‘¦2 + ğ‘§2 âˆ’ ğ‘™2
ğ’’ = ğ‘¥ ğ‘¦ ğ‘§ ğ‘‡
Non-holonomic Constraints
â€¢ If a constraint takes the form:
â€¢ Example (rolling disk)
â€¢ Rolling constraints:
ğœ‘ ğ’’, áˆ¶ ğ’’ = 0
ğ’’ = ğ‘¥ ğ‘¦ ğœƒ ğœ‘ ğ‘‡
áˆ¶
ğ‘¥ âˆ’ ğœŒ cos ğœƒ áˆ¶ ğœ‘ = 0
áˆ¶
ğ‘¦ âˆ’ ğœŒ sin ğœƒ áˆ¶ ğœ‘ = 0
ğœŒ
Sliding wedge with point mass
â€¢ What is ğ’’?
ğ’’ = ğ‘‹ ğ‘¥ ğ‘‡m
M
Î±
X
x
0
Double Pendulum
â€¢ What should the ğ’’â€™s be?m2
m1Î²
Î±
x1,y1
x2,y2
ğ’’ = ğ›¼ ğ›½ ğ‘‡
Kinetic Energy
â€¢ Total Kinetic Energy of system (ğ‘‡)
â€¢ For point particles:
â€¢ What about rigid bodies?
â€¢ Include rotational energy & inertias
ğ‘‡ = 1
2 à·
ğ‘–=1
ğ‘
ğ‘šğ‘– áˆ¶ ğ’“ğ’Š
ğŸ
ğ‘“(ğ’’, áˆ¶ ğ’’)
Potential Energy
â€¢ Potential Energy from Gravity (ğ‘½ğ’ˆğ’“ğ’‚ğ’—)
ğ‘‰ = à·
ğ‘–=1
ğ‘
ğ‘šğ‘– ğ‘”â„ğ‘–
ğ‘“(ğ’’)
â€¢ Potential Energy from springs (ğ‘½ğ’”)
ğ‘‰ = 1
2 à·
ğ‘–=1
ğ‘
ğ‘˜ğ‘– ğ‘¥ğ‘–
2 ğ‘“(ğ’’)
Lagrange Mechanics
â€¢ Admin
â€¢ Generalised
Coordinates
â€¢ Lagrange
Mechanics
Lecture 2:
Lagrange I
â€¢ Developed by Joseph Lagrange
â€¢ Derived from Calculus of Variations
â€¢ An energy-based method of describing
mechanics
â€¢ Great for constrained systems:
â€¢ Works with Generalised Coordinates
â€¢ Does not require constraint forces
The Lagrangian
ğ¿ ğ’’, áˆ¶ ğ’’ = ğ‘‡ ğ’’, áˆ¶ ğ’’ âˆ’ ğ‘‰ ğ’’
Total system Kinetic energy Potential energy
EOM
â€¢ Dynamic equation for coordinate ğ‘ğ‘–
ğ‘‘
ğ‘‘ğ‘¡
ğœ•ğ¿
ğœ• áˆ¶ ğ‘ğ‘–
âˆ’ ğœ•ğ¿
ğœ•ğ‘ğ‘–
= 0
â€¢ Repeat for all ğ‘–
Eg: Pendulum
ğ’’ = ğœƒ
â€¢ Generalised coords:
â€¢ Position:ÏÎ¸
(x,y)
m ğ’“ = ğœŒsin(ğœƒ)
âˆ’ğœŒcos(ğœƒ)
â€¢ Velocity: áˆ¶ ğ’“ = ğœŒcos(ğœƒ) áˆ¶ ğœƒ
ğœŒsin(ğœƒ) áˆ¶ ğœƒ
Eg: Pendulum
ğ‘‡ = 1
2 ğ‘š áˆ¶ ğ’“2
â€¢ Kinetic Energy:ÏÎ¸
(x,y)
m
= 1
2 ğ‘š[(ğœŒğ‘ğ‘œğ‘ (ğœƒ) áˆ¶ ğœƒ)2+(ğœŒğ‘ ğ‘–ğ‘›(ğœƒ) áˆ¶ ğœƒ)2]
= 1
2 ğ‘šğœŒ2 áˆ¶ ğœƒ2
Eg: Pendulum
ğ‘‰ = ğ‘šğ‘”ğ‘Ÿğ‘¦
â€¢ Potential Energy:ÏÎ¸
(x,y)
m
= ğ‘šğ‘”(âˆ’ğœŒ cos ğœƒ )
â€¢ Lagrangian:
ğ¿ = ğ‘‡ âˆ’ ğ‘‰
ğ¿ = 1
2 ğ‘šğœŒ2 áˆ¶ ğœƒ2 + ğ‘šğ‘”ğœŒ cos ğœƒ
EOM (Pendulum)
ğ‘‘
ğ‘‘ğ‘¡
ğœ•ğ¿
ğœ• áˆ¶ ğœƒ âˆ’ ğœ•ğ¿
ğœ•ğœƒ = 0
ğœ•ğ¿
ğœ• áˆ¶ ğœƒ = ğ‘šğœŒ2 áˆ¶ ğœƒ
ğ‘‘
ğ‘‘ğ‘¡
ğœ•ğ¿
ğœ• áˆ¶ ğœƒ = ğ‘šğœŒ2 áˆ· ğœƒ
ğœ•ğ¿
ğœ•ğœƒ = âˆ’ğ‘šğ‘”ğœŒsin(ğœƒ)
EOM (Pendulum)
ğ‘‘
ğ‘‘ğ‘¡
ğœ•ğ¿
ğœ• áˆ¶ ğœƒ âˆ’ ğœ•ğ¿
ğœ•ğœƒ = 0
ğ‘šğœŒ2 áˆ· ğœƒ + ğ‘šğ‘”ğœŒğ‘ ğ‘– ğ‘› ğœƒ = 0
ğœŒ áˆ· ğœƒ + ğ‘”ğ‘ ğ‘– ğ‘› ğœƒ = 0
áˆ·
ğœƒ = âˆ’ ğ‘”
ğœŒ ğ‘ ğ‘–ğ‘›(ğœƒ)
Eg: Mass with spring
ğ’’ = ğ‘¥
â€¢ Generalised coords:
â€¢ Position: ğ’“ = ğ‘¥
â€¢ Velocity: áˆ¶ ğ’“ = áˆ¶ ğ‘¥m
Î±
Eg: Mass with springm
Î±
ğ‘‰ğ‘” = âˆ’ğ‘šğ‘”ğ‘¥ğ‘ ğ‘–ğ‘› ğ›¼
â€¢ Potential Energy Gravity:
â€¢ Potential Energy Spring:
ğ‘‰ğ‘  = 1
2 ğ‘˜ğ‘¥2
Eg: Mass with spring
â€¢ Lagrangian:
ğ¿ = ğ‘‡ âˆ’ ğ‘‰
ğ¿ = 1
2 ğ‘š áˆ¶ ğ‘¥2 âˆ’ (âˆ’ğ‘šğ‘”ğ‘¥ğ‘ ğ‘–ğ‘› ğ›¼ + 1
2 ğ‘˜ğ‘¥2)
ğ¿ = 1
2 ğ‘š áˆ¶ ğ‘¥2 + ğ‘šğ‘”ğ‘¥ğ‘ ğ‘–ğ‘› ğ›¼ âˆ’ 1
2 ğ‘˜ğ‘¥2)
Eg: Mass with spring
â€¢ EOM: ğ‘‘
ğ‘‘ğ‘¡
ğœ•ğ¿
ğœ• áˆ¶ ğ‘¥ âˆ’ ğœ•ğ¿
ğœ•ğ‘¥ = 0
ğ‘‘
ğ‘‘ğ‘¡ ğ‘š áˆ¶ ğ‘¥ âˆ’ ğ‘šğ‘”ğ‘ ğ‘–ğ‘› ğ›¼ âˆ’ ğ‘˜ğ‘¥ = 0
ğ‘š áˆ· ğ‘¥ + ğ‘˜ğ‘¥ = ğ‘šğ‘”ğ‘ ğ‘–ğ‘› ğ›¼
ğ‘‘
ğ‘‘ğ‘¡
ğœ•ğ¿
ğœ• áˆ¶ ğ‘¥ âˆ’ ğœ•ğ¿
ğœ•ğ‘¥ = 0
Homework Exercisex,y
Î±
b
Î²
a
â€¢ Rigid rod attached
to a string
â€¢ Derive EOM
m, I
The end.
â€¢ Next lecture:
â€¢ Multibody
systems